{
  "name": "stripe",
  "version": "0.5.0",
  "title": "Stripe",
  "description": "Manage payments, subscriptions, and customers seamlessly. Execute workflows on charge failures and subscription updates.",
  "user": {
    "tags": {
      "id": {
        "title": "Stripe customer ID"
      }
    }
  },
  "events": {
    "chargeFailed": {
      "schema": {
        "type": "object",
        "properties": {
          "origin": {
            "type": "string",
            "const": "stripe",
            "description": "The origin of the event trigger"
          },
          "userId": {
            "type": "string",
            "description": "Botpress User ID"
          },
          "data": {
            "type": "object",
            "properties": {
              "type": {
                "type": "string",

                "default": "charge.failed"
              },
              "object": {
                "type": "object",
                "properties": {},
                "additionalProperties": true,
                "description": "The object of the failed charge"
              }
            },
            "required": ["object"],
            "additionalProperties": false,
            "description": "The data to send with the event"
          }
        },
        "required": ["origin", "userId", "data"],
        "additionalProperties": false
      },
      "title": "Charge Failed",
      "description": "This event occurs when a charge fails in Stripe."
    },
    "subscriptionDeleted": {
      "schema": {
        "type": "object",
        "properties": {
          "origin": {
            "type": "string",
            "const": "stripe",
            "description": "The origin of the event trigger"
          },
          "userId": {
            "type": "string",
            "description": "Botpress User ID"
          },
          "data": {
            "type": "object",
            "properties": {
              "type": {
                "type": "string",

                "default": "customer.subscription.deleted"
              },
              "object": {
                "type": "object",
                "properties": {},
                "additionalProperties": true,
                "description": "The object of the deleted subscription"
              }
            },
            "required": ["object"],
            "additionalProperties": false,
            "description": "The data to send with the event"
          }
        },
        "required": ["origin", "userId", "data"],
        "additionalProperties": false
      },
      "title": "Subscription Deleted",
      "description": "This event occurs when a subscription is canceled/deleted in Stripe."
    },
    "subscriptionUpdated": {
      "schema": {
        "type": "object",
        "properties": {
          "origin": {
            "type": "string",
            "const": "stripe",
            "description": "The origin of the event trigger"
          },
          "userId": {
            "type": "string",
            "description": "Botpress User ID"
          },
          "data": {
            "type": "object",
            "properties": {
              "type": {
                "type": "string",

                "default": "customer.subscription.updated"
              },
              "object": {
                "type": "object",
                "properties": {},
                "additionalProperties": true,
                "description": "The object of the updated subscription"
              }
            },
            "required": ["object"],
            "additionalProperties": false,
            "description": "The data to send with the event"
          }
        },
        "required": ["origin", "userId", "data"],
        "additionalProperties": false
      },
      "title": "Subscription Updated",
      "description": "This event occurs when a subscription is updated in Stripe. For example when the subscription is cancelled, but does not terminate immediately cancel_at_period_end goes to true."
    },
    "subscriptionCreated": {
      "schema": {
        "type": "object",
        "properties": {
          "origin": {
            "type": "string",
            "const": "stripe",
            "description": "The origin of the event trigger"
          },
          "userId": {
            "type": "string",
            "description": "Botpress User ID"
          },
          "data": {
            "type": "object",
            "properties": {
              "type": {
                "type": "string",

                "default": "customer.subscription.created"
              },
              "object": {
                "type": "object",
                "properties": {},
                "additionalProperties": true,
                "description": "The object of the created subscription"
              }
            },
            "required": ["object"],
            "additionalProperties": false,
            "description": "The data to send with the event"
          }
        },
        "required": ["origin", "userId", "data"],
        "additionalProperties": false
      },
      "title": "Subscription Created",
      "description": "This event occurs when a subscription is created in Stripe. For example when the subscription is cancelled, but does not terminate immediately cancel_at_period_end goes to true."
    },
    "invoicePaymentFailed": {
      "schema": {
        "type": "object",
        "properties": {
          "origin": {
            "type": "string",
            "const": "stripe",
            "description": "The origin of the event trigger"
          },
          "userId": {
            "type": "string",
            "description": "Botpress User ID"
          },
          "data": {
            "type": "object",
            "properties": {
              "type": {
                "type": "string",

                "default": "invoice.payment_failed"
              },
              "object": {
                "type": "object",
                "properties": {},
                "additionalProperties": true,
                "description": "The object of the invoice whose payment failed"
              }
            },
            "required": ["object"],
            "additionalProperties": false,
            "description": "The data to send with the event"
          }
        },
        "required": ["origin", "userId", "data"],
        "additionalProperties": false
      },
      "title": "Invoice Payment Failed",
      "description": "This event occurs when an invoice payment fails in Stripe."
    },
    "paymentIntentFailed": {
      "schema": {
        "type": "object",
        "properties": {
          "origin": {
            "type": "string",
            "const": "stripe",
            "description": "The origin of the event trigger"
          },
          "userId": {
            "type": "string",
            "description": "Botpress User ID"
          },
          "data": {
            "type": "object",
            "properties": {
              "type": {
                "type": "string",

                "default": "payment_intent.payment_failed"
              },
              "object": {
                "type": "object",
                "properties": {},
                "additionalProperties": true,
                "description": "The object of the payment intent that failed"
              }
            },
            "required": ["object"],
            "additionalProperties": false,
            "description": "The data to send with the event"
          }
        },
        "required": ["origin", "userId", "data"],
        "additionalProperties": false
      },
      "title": "Payment Intent Failed",
      "description": "This event occurs when a payment intent fails in Stripe."
    },
    "subscriptionScheduleCreated": {
      "schema": {
        "type": "object",
        "properties": {
          "origin": {
            "type": "string",
            "const": "stripe",
            "description": "The origin of the event trigger"
          },
          "userId": {
            "type": "string",
            "description": "Botpress User ID"
          },
          "data": {
            "type": "object",
            "properties": {
              "type": {
                "type": "string",

                "default": "subscription_schedule.created"
              },
              "object": {
                "type": "object",
                "properties": {},
                "additionalProperties": true,
                "description": "The object of the created subscription schedule"
              }
            },
            "required": ["object"],
            "additionalProperties": false,
            "description": "The data to send with the event"
          }
        },
        "required": ["origin", "userId", "data"],
        "additionalProperties": false
      },
      "title": "Subscription Schedule Created",
      "description": "This event occurs when a subscription schedule is created in Stripe."
    },
    "subscriptionScheduleUpdated": {
      "schema": {
        "type": "object",
        "properties": {
          "origin": {
            "type": "string",
            "const": "stripe",
            "description": "The origin of the event trigger"
          },
          "userId": {
            "type": "string",
            "description": "Botpress User ID"
          },
          "data": {
            "type": "object",
            "properties": {
              "type": {
                "type": "string",

                "default": "subscription_schedule.updated"
              },
              "object": {
                "type": "object",
                "properties": {},
                "additionalProperties": true,
                "description": "The object of the updated subscription schedule"
              }
            },
            "required": ["object"],
            "additionalProperties": false,
            "description": "The data to send with the event"
          }
        },
        "required": ["origin", "userId", "data"],
        "additionalProperties": false
      },
      "title": "Subscription Schedule Updated",
      "description": "This event occurs when a subscription schedule is updated in Stripe."
    }
  },
  "actions": {
    "createPaymentLink": {
      "title": "Create Payment Link",
      "input": {
        "schema": {
          "type": "object",
          "properties": {
            "productName": {
              "type": "string",
              "description": "The name of the product to be sold",
              "x-zui": {
                "placeholder": "ex: T-Shirt"
              }
            },
            "unit_amount": {
              "type": "number",
              "x-zui": {
                "title": "Unit Price"
              },
              "default": 0,
              "description": "The unit price in cents"
            },
            "currency": {
              "type": "string",

              "default": "usd",
              "description": "The currency in which the price will be expressed"
            },
            "quantity": {
              "type": "number",

              "default": 1,
              "description": "The quantity of the product being purchased"
            },
            "adjustableQuantity": {
              "type": "boolean",

              "default": false,
              "description": "Whether or not the quantity can be adjusted"
            },
            "adjustableQuantityMaximum": {
              "type": "number",
              "minimum": 2,
              "maximum": 999,
              "x-zui": {
                "title": "Max Quantity"
              },
              "default": 99,
              "description": "The maximum quantity the customer can purchase, up to 999"
            },
            "adjustableQuantityMinimum": {
              "type": "number",
              "minimum": 1,
              "maximum": 998,
              "x-zui": {
                "title": "Min Quantity"
              },
              "default": 1,
              "description": "The minimum quantity the customer can purchase"
            }
          },
          "required": ["productName"],
          "additionalProperties": false
        }
      },
      "output": {
        "schema": {
          "type": "object",
          "properties": {
            "id": {
              "type": "string"
            },
            "url": {
              "type": "string"
            }
          },
          "additionalProperties": false
        }
      }
    },
    "listProductPrices": {
      "title": "List Product Prices",
      "input": {
        "schema": {
          "type": "object",
          "properties": {},
          "additionalProperties": false
        }
      },
      "output": {
        "schema": {
          "type": "object",
          "properties": {
            "products": {
              "type": "object",
              "additionalProperties": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string"
                  },
                  "prices": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "unit_amount": {
                          "type": ["number", "null"]
                        },
                        "currency": {
                          "type": "string"
                        },
                        "recurring": {
                          "anyOf": [
                            {
                              "type": "object",
                              "properties": {},
                              "additionalProperties": true
                            },
                            {
                              "type": "null"
                            }
                          ]
                        }
                      },
                      "required": ["unit_amount", "currency"],
                      "additionalProperties": false
                    }
                  }
                },
                "required": ["name", "prices"],
                "additionalProperties": false
              }
            }
          },
          "additionalProperties": false
        }
      }
    },
    "createSubsLink": {
      "title": "Create Subscription Payment Link",
      "input": {
        "schema": {
          "type": "object",
          "properties": {
            "productName": {
              "type": "string",
              "description": "The name of the subscription product"
            },
            "unit_amount": {
              "type": "number",

              "default": 0,
              "description": "The unit price in cents"
            },
            "currency": {
              "type": "string",

              "default": "usd",
              "description": "The currency in which the price is expressed"
            },
            "quantity": {
              "type": "number",

              "default": 1,
              "description": "The quantity of the subscription being purchased"
            },
            "adjustableQuantity": {
              "type": "boolean",

              "default": false,
              "description": "Whether or not the quantity can be adjusted"
            },
            "adjustableQuantityMaximum": {
              "type": "number",
              "minimum": 2,
              "maximum": 999,
              "x-zui": {
                "title": "Max Quantity"
              },
              "default": 99,
              "description": "The maximum quantity the customer can purchase, up to 999"
            },
            "adjustableQuantityMinimum": {
              "type": "number",
              "minimum": 1,
              "maximum": 998,
              "x-zui": {
                "title": "Min Quantity"
              },
              "default": 1,
              "description": "The minimum quantity the customer can purchase"
            },
            "chargingInterval": {
              "type": "string",
              "x-zui": {
                "title": "Payment Interval"
              },
              "default": "month",
              "description": "The interval at which the customer will be charged"
            },
            "trial_period_days": {
              "type": "number",
              "minimum": 1,

              "description": "The number of free trial days for the subscription"
            },
            "description": {
              "type": "string",

              "description": "A description of the subscription product"
            }
          },
          "required": ["productName"],
          "additionalProperties": false
        }
      },
      "output": {
        "schema": {
          "type": "object",
          "properties": {
            "id": {
              "type": "string"
            },
            "url": {
              "type": "string"
            }
          },
          "additionalProperties": false
        }
      }
    },
    "listPaymentLinks": {
      "title": "List Payment Links",
      "input": {
        "schema": {
          "type": "object",
          "properties": {},
          "additionalProperties": false
        }
      },
      "output": {
        "schema": {
          "type": "object",
          "properties": {
            "paymentLinks": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "id": {
                    "type": "string"
                  },
                  "url": {
                    "type": "string"
                  }
                },
                "required": ["id", "url"],
                "additionalProperties": false
              }
            }
          },
          "additionalProperties": false
        }
      }
    },
    "findPaymentLink": {
      "title": "Find Payment Link",
      "input": {
        "schema": {
          "type": "object",
          "properties": {
            "url": {
              "type": "string",
              "description": "The URL of the payment link",
              "x-zui": {
                "title": "Payment link",
                "placeholder": "ex: https://buy.stripe.com/test_b0tPr3sS5w3sOm3"
              }
            }
          },
          "required": ["url"],
          "additionalProperties": false
        }
      },
      "output": {
        "schema": {
          "type": "object",
          "properties": {
            "id": {
              "type": "string"
            }
          },
          "additionalProperties": false
        }
      }
    },
    "deactivatePaymentLink": {
      "title": "Deactivate Payment Link",
      "input": {
        "schema": {
          "type": "object",
          "properties": {
            "id": {
              "type": "string",
              "description": "The payment link ID to deactivate",
              "x-zui": {
                "placeholder": "ex: test_aEUdTEdRP95RdvaaEJ"
              }
            }
          },
          "required": ["id"],
          "additionalProperties": false
        }
      },
      "output": {
        "schema": {
          "type": "object",
          "properties": {
            "id": {
              "type": "string"
            },
            "url": {
              "type": "string"
            },
            "active": {
              "type": "boolean"
            }
          },
          "additionalProperties": false
        }
      }
    },
    "listCustomers": {
      "title": "List Customers By Email",
      "input": {
        "schema": {
          "type": "object",
          "properties": {
            "email": {
              "type": "string",
              "format": "email",
              "maxLength": 512,

              "description": "The e-mail of the customer to search for"
            }
          },
          "additionalProperties": false
        }
      },
      "output": {
        "schema": {
          "type": "object",
          "properties": {
            "customers": {
              "type": "object",
              "additionalProperties": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string"
                    },
                    "email": {
                      "type": ["string", "null"]
                    },
                    "name": {
                      "type": ["string", "null"]
                    },
                    "description": {
                      "type": ["string", "null"]
                    },
                    "phone": {
                      "type": ["string", "null"]
                    },
                    "address": {
                      "anyOf": [
                        {
                          "type": "object",
                          "properties": {},
                          "additionalProperties": true
                        },
                        {
                          "type": "null"
                        }
                      ]
                    },
                    "created": {
                      "type": "number"
                    },
                    "delinquent": {
                      "type": ["boolean", "null"]
                    }
                  },
                  "required": ["id", "email", "description", "created"],
                  "additionalProperties": true
                }
              }
            }
          },
          "additionalProperties": false
        }
      }
    },
    "searchCustomers": {
      "title": "Search Customers By Fields",
      "input": {
        "schema": {
          "type": "object",
          "properties": {
            "email": {
              "type": "string",
              "maxLength": 512,

              "description": "Search by query on customer emails"
            },
            "name": {
              "type": "string",

              "description": "Search by query on customer name"
            },
            "phone": {
              "type": "string",

              "description": "Search by query on customer phone number"
            }
          },
          "additionalProperties": false
        }
      },
      "output": {
        "schema": {
          "type": "object",
          "properties": {
            "customers": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "id": {
                    "type": "string"
                  },
                  "email": {
                    "type": ["string", "null"]
                  },
                  "name": {
                    "type": ["string", "null"]
                  },
                  "description": {
                    "type": ["string", "null"]
                  },
                  "phone": {
                    "type": ["string", "null"]
                  },
                  "address": {
                    "anyOf": [
                      {
                        "type": "object",
                        "properties": {},
                        "additionalProperties": true
                      },
                      {
                        "type": "null"
                      }
                    ]
                  },
                  "created": {
                    "type": "number"
                  },
                  "delinquent": {
                    "type": ["boolean", "null"]
                  }
                },
                "required": ["id", "email", "description", "created"],
                "additionalProperties": true
              }
            }
          },
          "additionalProperties": false
        }
      }
    },
    "createCustomer": {
      "title": "Create Customer",
      "input": {
        "schema": {
          "type": "object",
          "properties": {
            "email": {
              "type": "string",
              "format": "email",
              "maxLength": 512,
              "description": "The email of the customer",
              "x-zui": {
                "placeholder": "johndoe@botpress.com"
              }
            },
            "name": {
              "type": "string",
              "x-zui": {
                "placeholder": "John Doe"
              },
              "description": "The name of the customer"
            },
            "phone": {
              "type": "string",
              "x-zui": {
                "placeholder": "+1234567890"
              },
              "description": "The phone number of the customer"
            },
            "description": {
              "type": "string",
              "x-zui": {
                "placeholder": "Customer Description"
              },
              "description": "A description for the customer"
            },
            "paymentMethodId": {
              "type": "string",
              "x-zui": {
                "placeholder": "payment-method-id"
              },
              "description": "The ID of the payment method to attach to the customer"
            },
            "address": {
              "type": "string",
              "x-zui": {
                "placeholder": "123 Bot Street, Bot City, Botland, 12345"
              },
              "description": "The address of the customer"
            }
          },
          "required": ["email"],
          "additionalProperties": false
        }
      },
      "output": {
        "schema": {
          "type": "object",
          "properties": {
            "customer": {
              "type": "object",
              "properties": {
                "id": {
                  "type": "string"
                },
                "email": {
                  "type": ["string", "null"]
                },
                "name": {
                  "type": ["string", "null"]
                },
                "description": {
                  "type": ["string", "null"]
                },
                "phone": {
                  "type": ["string", "null"]
                },
                "address": {
                  "anyOf": [
                    {
                      "type": "object",
                      "properties": {},
                      "additionalProperties": true
                    },
                    {
                      "type": "null"
                    }
                  ]
                },
                "created": {
                  "type": "number"
                },
                "delinquent": {
                  "type": ["boolean", "null"]
                }
              },
              "required": ["id", "email", "description", "created"],
              "additionalProperties": true
            }
          },
          "additionalProperties": false
        }
      }
    },
    "createOrRetrieveCustomer": {
      "title": "Create Or Retrieve Customer",
      "input": {
        "schema": {
          "type": "object",
          "properties": {
            "email": {
              "type": "string",
              "format": "email",
              "maxLength": 512,
              "description": "The email of the customer",
              "x-zui": {
                "placeholder": "johndoe@botpress.com"
              }
            },
            "name": {
              "type": "string",
              "x-zui": {
                "placeholder": "John Doe"
              },
              "description": "The name of the customer"
            },
            "phone": {
              "type": "string",
              "x-zui": {
                "placeholder": "+1234567890"
              },
              "description": "The phone number of the customer"
            },
            "description": {
              "type": "string",
              "x-zui": {
                "placeholder": "Customer Description"
              },
              "description": "A description for the customer"
            },
            "paymentMethodId": {
              "type": "string",
              "x-zui": {
                "placeholder": "payment-method-id"
              },
              "description": "The ID of the payment method to attach to the customer"
            },
            "address": {
              "type": "string",
              "x-zui": {
                "placeholder": "123 Bot Street, Bot City, Botland, 12345"
              },
              "description": "The address of the customer"
            }
          },
          "required": ["email"],
          "additionalProperties": false
        }
      },
      "output": {
        "schema": {
          "type": "object",
          "properties": {
            "customer": {
              "type": "object",
              "properties": {
                "id": {
                  "type": "string"
                },
                "email": {
                  "type": ["string", "null"]
                },
                "name": {
                  "type": ["string", "null"]
                },
                "description": {
                  "type": ["string", "null"]
                },
                "phone": {
                  "type": ["string", "null"]
                },
                "address": {
                  "anyOf": [
                    {
                      "type": "object",
                      "properties": {},
                      "additionalProperties": true
                    },
                    {
                      "type": "null"
                    }
                  ]
                },
                "created": {
                  "type": "number"
                },
                "delinquent": {
                  "type": ["boolean", "null"]
                }
              },
              "required": ["id", "email", "description", "created"],
              "additionalProperties": true
            },
            "customers": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "id": {
                    "type": "string"
                  },
                  "email": {
                    "type": ["string", "null"]
                  },
                  "name": {
                    "type": ["string", "null"]
                  },
                  "description": {
                    "type": ["string", "null"]
                  },
                  "phone": {
                    "type": ["string", "null"]
                  },
                  "address": {
                    "anyOf": [
                      {
                        "type": "object",
                        "properties": {},
                        "additionalProperties": true
                      },
                      {
                        "type": "null"
                      }
                    ]
                  },
                  "created": {
                    "type": "number"
                  },
                  "delinquent": {
                    "type": ["boolean", "null"]
                  }
                },
                "required": ["id", "email", "description", "created"],
                "additionalProperties": true
              }
            }
          },
          "additionalProperties": false
        }
      }
    },
    "retrieveCustomerById": {
      "title": "Retrieve Customer By ID",
      "input": {
        "schema": {
          "type": "object",
          "properties": {
            "id": {
              "type": "string",
              "description": "The ID of the customer to retrieve",
              "x-zui": {
                "placeholder": "cus_1234567890"
              }
            }
          },
          "required": ["id"],
          "additionalProperties": false
        }
      },
      "output": {
        "schema": {
          "type": "object",
          "properties": {
            "id": {
              "type": "string"
            },
            "email": {
              "type": ["string", "null"]
            },
            "description": {
              "type": ["string", "null"]
            },
            "created": {
              "type": "number"
            }
          },
          "additionalProperties": true
        }
      }
    }
  },
  "channels": {},
  "states": {
    "stripeIntegrationInfo": {
      "type": "integration",
      "schema": {
        "type": "object",
        "properties": {
          "stripeWebhookId": {
            "type": "string"
          }
        },
        "required": ["stripeWebhookId"],
        "additionalProperties": false
      }
    }
  },
  "interfaces": {}
}
